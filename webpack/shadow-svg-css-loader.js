// Generated by CoffeeScript 1.12.7
var buildCss, debug, getUniqueStr, saveFile, utils;

utils = require('loader-utils');

debug = require('debug')('loader/svg');

buildCss = function(origData, uniqueStr) {
  var fileName, namespace, newData;
  fileName = "some-files";
  namespace = fileName + "-svg ";
  newData = origData;
  newData = newData.replace(/(\.st[0-9]+)/g, "$1_" + uniqueStr);
  newData = newData.replace(/(SVGID_[0-9]+_)/g, "$1" + uniqueStr);
  newData = newData.replace(/(font-size:[0-9\.]+);/g, '$1px;');
  newData = newData.replace(/[\s\S]*<style type="text\/css">([\s\S]*)<\/style>[\s\S]*/g, '$1');
  newData = newData.replace(/enable-background:new\s+;/g, '');
  newData = newData.replace(/\s+(\.[a-z0-9]+?{.+)/g, "." + namespace + "$1\n");
  return newData;
};

saveFile = function(fileContents, loader) {
  var fileName;
  fileName = loader.resourcePath.split('/').pop().split(".");
  fileName.pop();
  fileName.push("scss");
  return loader.emitFile("./" + (fileName.join('.')), fileContents);
};

getUniqueStr = function(context) {
  var uniqueStr;
  uniqueStr = utils.getOptions(context).uniqueStr;
  if (uniqueStr == null) {
    return "";
  } else {
    return uniqueStr;
  }
};

module.exports = function(data) {
  var uniqueStr;
  uniqueStr = getUniqueStr(this);
  return buildCss(data, uniqueStr);
};
